{% extends 'base.html' %}
{% block title %}Unit {{ unit_id }} - Radio Exchange Practice{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/noticing_numbers.css') }}">
{% endblock %}

{% block content %}
<!-- HEADER -->
<header class="top-bar">
    <div class="container d-flex justify-content-end align-items-center header-right-group">
        <a href="{{ url_for('learning.learning_unit', unit_id=unit_id, section='noticing_alphabet') }}" class="btn-learn-nav btn-back" aria-label="Back to Alphabet">
            <i class="fas fa-chevron-left me-1"></i>
            <span class="btn-text">Back</span>
        </a>
        
        <div class="current-unit-title d-flex align-items-center ms-3 me-3">
            <i class="fas fa-anchor me-2"></i>
            <span><span>Unit {{ unit_id }} - {{ unit_data.title }}</span></span>
        </div>

        <a href="{{ url_for('main.home') }}" class="btn-learn-nav btn-home" aria-label="Home">
            <i class="fas fa-home"></i>
        </a>
    </div>
</header>

<!-- MAIN CONTENT -->
<div class="main-content">
    
    <!-- LEFT SIDEBAR -->
    <aside class="exchange-sidebar">
        
        <!-- Title Container -->
        <div class="title-container">
            <div class="main-title">
                <i class="fa-solid fa-user-tie"></i>
                Practice with the Crew
            </div>
            <div class="sub-title">
                Activity 7: Radio Exchange Practice
            </div>
        </div>

        <!-- Captain Section -->
        <img src="{{ url_for('static', filename='img/captain_radio_check_5.png') }}" alt="Captain Character" class="captain-image">
        
        <!-- Speech Bubble -->
        <div class="exchange-bubble">
            <p class="speech-text-exchange">
                "Alright, cadets! This time you'll practice real radio exchanges - sending and receiving messages just like on board! Listen carefully and follow each step with confidence."
            </p>
            
            <div class="exchange-controls">
                <i class="fa-solid fa-play"></i>
                <i class="fa-solid fa-language"></i>
            </div>
        </div>
        
    </aside>

    <!-- RIGHT CONTENT -->
    <main class="activity-area">
        
        <!-- Activity Header -->
        <div class="activity-area-title">
            <i class="fa-solid fa-comments"></i>
            <p class="instruction-text-exchange">
                Listen to the example, then complete both tasks: <strong>Task 1</strong> - Act as the caller and speak clearly. <strong>Task 2</strong> - Act as the receiver and respond correctly.
            </p>
        </div>
        
        <!-- EXAMPLE SECTION -->
        <section class="practice-section example-section">
            <div class="section-header">
                <i class="fas fa-star"></i>
                <h3>Example Exchange</h3>
                <span class="section-badge">Listen & Learn</span>
            </div>
            
            <div class="exchange-row">
                <!-- Caller Example -->
                <div class="exchange-card caller-card">
                    <div class="card-header">
                        <i class="fas fa-ship"></i>
                        <span>Caller (Sending)</span>
                    </div>
                    
                    <div class="vessel-display">
                        <div class="vessel-avatar">
                            <img src="{{ url_for('static', filename='img/captain_radio_check_6.png') }}" alt="Horizon">
                        </div>
                        <div class="vessel-info-box">
                            <div class="info-row">
                                <label>Vessel:</label>
                                <value>HORIZON</value>
                            </div>
                            <div class="info-row">
                                <label>MMSI:</label>
                                <value>248105900</value>
                            </div>
                            <div class="info-row">
                                <label>Call Sign:</label>
                                <value>YBON9</value>
                            </div>
                        </div>
                    </div>
                    
                    <button class="audio-play-btn" data-audio="example-caller">
                        <i class="fas fa-play"></i>
                        <span>Play Caller</span>
                    </button>
                </div>

                <!-- Arrow -->
                <div class="exchange-arrow">
                    <i class="fas fa-arrow-right"></i>
                </div>

                <!-- Receiver Example -->
                <div class="exchange-card receiver-card">
                    <div class="card-header">
                        <i class="fas fa-ship"></i>
                        <span>Receiver (Responding)</span>
                    </div>
                    
                    <div class="vessel-display">
                        <div class="vessel-avatar">
                            <img src="{{ url_for('static', filename='img/captain_radio_check_7.png') }}" alt="Antares">
                        </div>
                        <div class="vessel-info-box">
                            <div class="info-row">
                                <label>Vessel:</label>
                                <value>ANTARES</value>
                            </div>
                            <div class="info-row">
                                <label>MMSI:</label>
                                <value>257689000</value>
                            </div>
                            <div class="info-row">
                                <label>Call Sign:</label>
                                <value>LAPW5</value>
                            </div>
                        </div>
                    </div>
                    
                    <button class="audio-play-btn" data-audio="example-receiver">
                        <i class="fas fa-play"></i>
                        <span>Play Receiver</span>
                    </button>
                </div>
            </div>

            <button class="play-full-btn">
                <i class="fas fa-play-circle"></i>
                Play Full Example
            </button>
        </section>

        <!-- TASK 1 SECTION -->
        <section class="practice-section task-section">
            <div class="section-header">
                <i class="fas fa-microphone"></i>
                <h3>Task 1: You are the Caller</h3>
                <span class="section-badge task1-badge">Your Turn</span>
            </div>
            
            <div class="exchange-row">
                <!-- Your Card (Caller) -->
                <div class="exchange-card your-card">
                    <div class="card-header">
                        <i class="fas fa-user"></i>
                        <span>You (Calling)</span>
                    </div>
                    
                    <div class="vessel-display">
                        <div class="vessel-avatar">
                            <img src="{{ url_for('static', filename='img/captain_radio_check_8.png') }}" alt="Adour">
                        </div>
                        <div class="vessel-info-box">
                            <div class="info-row">
                                <label>Vessel:</label>
                                <value>ADOUR</value>
                            </div>
                            <div class="info-row">
                                <label>MMSI:</label>
                                <value>635005000</value>
                            </div>
                            <div class="info-row">
                                <label>Call Sign:</label>
                                <value>FQEP</value>
                            </div>
                        </div>
                    </div>
                    
                    <button class="mic-btn" data-task="task1-caller" data-card-index="0">
                        <i class="fas fa-microphone"></i>
                        <span>Start Recording</span>
                    </button>
                </div>

                <!-- Arrow -->
                <div class="exchange-arrow">
                    <i class="fas fa-arrow-right"></i>
                </div>

                <!-- Target Card (They Receive) -->
                <div class="exchange-card target-card">
                    <div class="card-header">
                        <i class="fas fa-ship"></i>
                        <span>Target Vessel</span>
                    </div>
                    
                    <div class="vessel-display">
                        <div class="vessel-avatar">
                            <img src="{{ url_for('static', filename='img/captain_radio_check_4.png') }}" alt="Apollon">
                        </div>
                        <div class="vessel-info-box">
                            <div class="info-row">
                                <label>Vessel:</label>
                                <value>APOLLON</value>
                            </div>
                            <div class="info-row">
                                <label>MMSI:</label>
                                <value>237002600</value>
                            </div>
                            <div class="info-row">
                                <label>Call Sign:</label>
                                <value>SWFP</value>
                            </div>
                        </div>
                    </div>
                    
                    <button class="audio-play-btn" data-audio="task1-target">
                        <i class="fas fa-play"></i>
                        <span>Hear Response</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- TASK 2 SECTION -->
        <section class="practice-section task-section">
            <div class="section-header">
                <i class="fas fa-microphone"></i>
                <h3>Task 2: You are the Receiver</h3>
                <span class="section-badge task2-badge">Your Turn</span>
            </div>
            
            <div class="exchange-row">
                <!-- Incoming Card (They Call) -->
                <div class="exchange-card target-card">
                    <div class="card-header">
                        <i class="fas fa-ship"></i>
                        <span>Calling Vessel</span>
                    </div>
                    
                    <div class="vessel-display">
                        <div class="vessel-avatar">
                            <img src="{{ url_for('static', filename='img/captain_radio_check_9.png') }}" alt="Baystar">
                        </div>
                        <div class="vessel-info-box">
                            <div class="info-row">
                                <label>Vessel:</label>
                                <value>BAYSTAR</value>
                            </div>
                            <div class="info-row">
                                <label>MMSI:</label>
                                <value>440983000</value>
                            </div>
                            <div class="info-row">
                                <label>Call Sign:</label>
                                <value>DSON9</value>
                            </div>
                        </div>
                    </div>
                    
                    <button class="audio-play-btn" data-audio="task2-incoming">
                        <i class="fas fa-play"></i>
                        <span>Hear Call</span>
                    </button>
                </div>

                <!-- Arrow -->
                <div class="exchange-arrow">
                    <i class="fas fa-arrow-right"></i>
                </div>

                <!-- Your Card (Receiver) -->
                <div class="exchange-card your-card">
                    <div class="card-header">
                        <i class="fas fa-user"></i>
                        <span>You (Responding)</span>
                    </div>
                    
                    <div class="vessel-display">
                        <div class="vessel-avatar">
                            <img src="{{ url_for('static', filename='img/captain_radio_check_3.png') }}" alt="Sunshine">
                        </div>
                        <div class="vessel-info-box">
                            <div class="info-row">
                                <label>Vessel:</label>
                                <value>SUNSHINE</value>
                            </div>
                            <div class="info-row">
                                <label>MMSI:</label>
                                <value>369855000</value>
                            </div>
                            <div class="info-row">
                                <label>Call Sign:</label>
                                <value>NBAC</value>
                            </div>
                        </div>
                    </div>
                    
                    <button class="mic-btn" data-task="task2-receiver" data-card-index="1">
                        <i class="fas fa-microphone"></i>
                        <span>Start Recording</span>
                    </button>
                </div>
            </div>
        </section>
        
    </main>

</div>

<!-- FOOTER -->
<footer class="footer-nav">
    <a href="{{ url_for('learning.learning_unit', unit_id=unit_id, section='guided_intro') }}" class="continue-button">
        <span>Continue</span>
        <i class="fas fa-chevron-right ms-1"></i>
    </a>
</footer>

{% endblock %}

{% block page_js %}
<script>
    window.UNIT_CONTENT = {{ (content or {})|tojson|safe }};
    window.SECTION_CONTENT = {{ (section_content or {})|tojson|safe }};
    window.UNIT_ID = {{ unit_id | default(0) }};
</script>
<script src="{{ url_for('static', filename='js/noticing_numbers.js') }}"></script>
{% endblock %}