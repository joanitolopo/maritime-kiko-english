{% extends 'base.html' %}
{% block title %}Unit {{ unit_id }} - Radio Spelling Practice{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/noticing_numbers.css') }}">
<!-- <link rel="stylesheet" href="{{ url_for('static', filename='css/input_mmsi.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/input_vhf.css') }}"> -->
{% endblock %}

{% block content %}
<!-- HEADER -->
<header class="top-bar">
    <div class="container d-flex justify-content-end align-items-center header-right-group">
        <a href="{{ url_for('learning.learning_unit', unit_id=unit_id, section='noticing_intro') }}" class="btn-learn-nav btn-back" aria-label="Back to Noticing Intro">
            <i class="fas fa-chevron-left me-1"></i>
            <span class="btn-text">Back</span>
        </a>
        
        <div class="current-unit-title d-flex align-items-center ms-3 me-3">
            <i class="fas fa-anchor me-2"></i>
            <span>Unit {{ unit_id }} - {{ unit_data.title }}</span>
        </div>

        <a href="{{ url_for('main.home') }}" class="btn-learn-nav btn-home" aria-label="Home">
            <i class="fas fa-home"></i>
        </a>
    </div>
</header>

<!-- MAIN CONTENT -->
<div class="mmsi-container">
    
    <!-- LEFT SIDEBAR -->
    <aside class="mmsi-sidebar">
        
        <div class="activity-badge">
            <div class="badge-icon">
                <i class="fa-solid fa-anchor"></i>
            </div>
            <div class="badge-text">
                <h4>E. Drill It Like a Seafarer</h4>
            </div>
        </div>

        <!-- Captain Section with Radio Waves -->
        <div class="captain-instruction-card">
            <div class="captain-avatar-wrapper">
                <img src="{{ url_for('static', filename='img/Captain male-3.png') }}" alt="Captain Character" class="captain-avatar">
                <div class="radio-waves">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            
            <!-- Speech Bubble -->
            <div class="instruction-bubble">
                <p class="speech-text-mmsi">
                    Cadets, it's time to drill your pronunciation! Listen carefully to the example, then spell and say each vessel's identification clearly — just like a real seafarer!
                </p>
                
                <div class="mmsi-controls">
                    <button class="control-btn audio-btn" id="captain-audio-btn">
                        <i class="fa-solid fa-play"></i>
                    </button>
                    <button class="control-btn translate-btn" id="translate-btn">
                        <i class="fa-solid fa-language"></i>
                        <span>Translate</span>
                    </button>
                </div>
            </div>
        </div>
    </aside>

    <!-- RIGHT CONTENT -->
    <main class="mmsi-main">
        <section class="activity-card spell-sea-activity">
            <div class="activity-header">
                <div class="header-left">
                    <i class="fa-solid fa-comment activity-number"></i>
                    <div class="header-text">
                        <h3>Activity 6: Radio Spelling Practice</h3>
                        <p>Learn radio communication with real vessel examples</p>
                    </div>
                </div>
            </div>

            <div class="activity-body">
                <div class="instruction-banner">
                    <div class="banner-icon">
                        <i class="fas fa-headphones"></i>
                    </div>
                    <div class="banner-text">
                        <p class="instruction-text-mmsi" >
                            Listen to the example, then read your vessel card and say the name, MMSI, and Call Sign using the same format. Speak clearly.
                        </p>
                    </div>
                </div>

                <div class="activity-part">
                    <h4 class="part-title">
                        <span class="part-number">Example</span>
                        Vessel: ANTARES
                    </h4>
                    
                    <!-- Communication Card -->
                    <div class="communication-card">
                        
                        <!-- Left: Character & Info -->
                        <div class="card-left">
                            <div class="character-section">
                                <img src="{{ url_for('static', filename='img/operator_vessel_antara.png') }}" alt="Radio Operator" class="operator-img">
                            </div>
                            
                            <div class="vessel-info-section">
                                <div class="info-header">
                                    <i class="fas fa-ship"></i>
                                    <span>Vessel Information</span>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-anchor"></i> Name</label>
                                    <value>ANTARES</value>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-hashtag"></i> MMSI</label>
                                    <value class="mmsi-number">257689000</value>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-broadcast-tower"></i> Call Sign</label>
                                    <value class="call-sign">LAPW5</value>
                                </div>

                                <!-- ✅ KEMBALIKAN BUTTON INI -->
                                <button class="play-button" id="example-play-btn" data-audio-src="/static/data/audio/unit1/mmsi_example.wav">
                                    <i class="fas fa-play"></i>
                                    <span>Play</span>
                                </button>
                            </div>
                        </div>

                        <!-- Right: Transcript -->
                        <div class="card-right">
                            <div class="transcript-section">
                                <div class="transcript-header">
                                    <i class="fas fa-file-alt"></i>
                                    <span>Radio Communication Transcript</span>
                                </div>
                                
                                <div class="transcript-content">
                                    <div class="transcript-line">
                                        <span class="speaker">Vessel:</span>
                                        <span class="message">
                                            "This is Too - Fife - Seven - Six - Ait - Niner - ZEE-ro - ZEE-ro - ZEE-ro. 
                                            Motor Vessel "ANTARES" Alfa - November - Tango - Alfa - Romeo - Echo - Sierra. Call Sign Lima - Alfa - Papa - Whisky - Fife."</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="roleplay-header">
                    <div class="roleplay-header-main">
                        <i class="fa-solid fa-hand-point-right"></i>
                        <h3 class="roleplay-title-text">Your Turn - Speak Clearly</h3>
                    </div>
                    <p class="roleplay-subtitle">Follow the same format as the example above.</p>
                </div>  

                <!-- PART 1: Your Turn - APOLLON -->
                <div class="activity-part">
                    <h4 class="part-title">
                        <span class="part-number">Part 1</span>
                        Your Turn: APOLLON
                    </h4>
                    
                    <!-- Communication Card -->
                    <div class="communication-card">
                        
                        <div class="card-left">
                            <div class="character-section clickable-image show-overlay" data-task="task1" data-type="speak">
                                <!-- User profile image - conditional based on gender -->
                                {% if user_info and user_info.gender == 'Female' %}
                                    <img src="{{ url_for('static', filename='img/Cadet female-4.png') }}" 
                                        alt="Your Profile" 
                                        class="operator-img user-profile-img">
                                {% else %}
                                    <img src="{{ url_for('static', filename='img/Cadet male-6.png') }}" 
                                        alt="Your Profile" 
                                        class="operator-img user-profile-img">
                                {% endif %}
                                <div class="image-overlay permanent-overlay">
                                    <div class="mic-icon">
                                        <i class="fas fa-microphone"></i>
                                    </div>
                                    <p class="overlay-instruction">Click to Record</p>
                                </div>
                            </div>
                            
                            <div class="vessel-info-section">
                                <div class="info-header">
                                    <i class="fas fa-ship"></i>
                                    <span>Vessel Information</span>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-anchor"></i> Name</label>
                                    <value>APOLLON</value>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-hashtag"></i> MMSI</label>
                                    <value class="mmsi-number">237002600</value>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-broadcast-tower"></i> Call Sign</label>
                                    <value class="call-sign">SWFP</value>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Divider -->
                <div class="part-divider"></div>

                <!-- PART 2: Your Turn - BAYSTAR -->
                <div class="activity-part">
                    <h4 class="part-title">
                        <span class="part-number">Part 2</span>
                        Your Turn: BAYSTAR
                    </h4>
                    
                    <!-- Communication Card -->
                    <div class="communication-card">
                        
                        <!-- Card Left: Character & Vessel Info -->
                        <div class="card-left">
                            <div class="character-section clickable-image show-overlay" data-task="task2" data-type="speak">
                                <!-- User profile image - conditional based on gender -->
                                {% if user_info and user_info.gender == 'Female' %}
                                    <img src="{{ url_for('static', filename='img/Cadet female-4.png') }}" 
                                        alt="Your Profile" 
                                        class="operator-img user-profile-img">
                                {% else %}
                                    <img src="{{ url_for('static', filename='img/Cadet male-6.png') }}" 
                                        alt="Your Profile" 
                                        class="operator-img user-profile-img">
                                {% endif %}
                                <div class="image-overlay permanent-overlay">
                                    <div class="mic-icon">
                                        <i class="fas fa-microphone"></i>
                                    </div>
                                    <p class="overlay-instruction">Click to Record</p>
                                </div>
                            </div>
                            
                            <div class="vessel-info-section">
                                <div class="info-header">
                                    <i class="fas fa-ship"></i>
                                    <span>Vessel Information</span>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-anchor"></i> Name</label>
                                    <value>BAYSTAR</value>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-hashtag"></i> MMSI</label>
                                    <value class="mmsi-number">440983000</value>
                                </div>
                                
                                <div class="info-item">
                                    <label><i class="fas fa-broadcast-tower"></i> Call Sign</label>
                                    <value class="call-sign">DSON9</value>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </section>


        <!-- Continue Button - Hidden by default -->
        <div class="continue-wrapper" style="display: none;">
            <a href="{{ url_for('learning.complete_subunit', unit_id=unit_id, subunit_index=5) }}"  class="continue-button">
            <span>Continue Sailing</span>
            </a>
        </div>
    </main>

</div>

<!-- FOOTER -->


{% endblock %}

{% block page_js %}
<script>
    window.UNIT_CONTENT = {{ (content or {})|tojson|safe }};
    window.SECTION_CONTENT = {{ (section_content or {})|tojson|safe }};
    window.UNIT_ID = {{ unit_id | default(0) }};
</script>
<script src="{{ url_for('static', filename='js/noticing_numbers.js') }}"></script>
{% endblock %}